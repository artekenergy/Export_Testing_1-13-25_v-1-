<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&display=swap"
      rel="stylesheet"
    />
    <title>WebSocket Remote Control</title>
    <style>
      /* ------------------ FONT IMPORT ------------------ */
      @font-face {
        font-family: "Cy-ExtraBold";
        src: url("fonts/Cy-ExtraBold.woff2") format("woff2"),
          url("fonts/Cy-ExtraBold.woff") format("woff"),
          url("fonts/Cy-ExtraBold.ttf") format("truetype");
        font-weight: normal;
        font-style: normal;
      }

      :root {
        --accent-color: #ffaa3b;
      }

      /* ------------------ BASE STYLES ------------------ */
      body {
        background-color: #2f445c;
        font-family: "Segoe UI", Arial, sans-serif;
        color: #122d39;
        margin: 30px 30px;
      }

      h2 {
        margin-top: 0;
        color: #e5e0e6;
        font-weight: 500;
        margin-bottom: 4px;
        padding-bottom: 2px;
      }

      label {
        font-weight: 500;
        margin-right: 5px;
      }

      span {
        color: #e5e0e6;
        font-weight: 500;
        font-family: Cy-ExtraBold;
        font-size: 10px;
        letter-spacing: 3px;
        text-transform: uppercase;
      }

      span,
      .header {
        font-family: "Cy-ExtraBold", "Segoe UI", Arial, sans-serif;
      }

      /* ------------------ HEADER ------------------ */
      .header {
        font-family: Cy-ExtraBold;
        letter-spacing: 3px;
        text-transform: uppercase;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        border-bottom: 2px solid #e5e0e6;
      }

      .home-logo {
        width: auto;
        height: 80px;
        padding-left: 20px;
      }

      /* ------------------ FORM ELEMENTS ------------------ */
      input[type="text"] {
        padding: 10px;
        border: 1px solid #e5e0e6;
        border-radius: 4px;
        margin: 0 10px 10px 0;
      }

      /* ------------------ LAYOUT STRUCTURE ------------------ */
      .home-page {
        display: flex;
        flex-direction: row;
        align-items: flex-start;
      }

      .home-page .status-messages {
        flex: 0 0 350px;
        margin-left: 30px;
        height: 350px;
      }

      .home-page .button-grid {
        flex: 1;
        margin-left: 20px;
      }

      .temps {
        display: flex;
        margin: 0 10px;
      }

      .temps > *:not(:last-child) {
        margin-right: 20px;
      }

      .temp-value,
      .time-value {
        font-size: 16px;
        font-weight: bold;
        color: #fff;
        padding-right: 10px;
      }

      /* ------------------ COMPONENTS ------------------ */
      .control-group {
        border: none;
        border-radius: 8px;
        margin-bottom: 20px;
      }

      .connection-status {
        padding: 12px;
        margin-bottom: 20px;
        border-radius: 6px;
        font-weight: 500;
        text-align: center;
      }

      .connected {
        background-color: #dff0d8;
        color: #3c763d;
      }

      .disconnected {
        background-color: #f2dede;
        color: #a94442;
      }

      .status-messages-list > *:not(:last-child),
      .status-messages-list-values > *:not(:last-child),
      .power-column > *:not(:last-child),
      .power-controls-grid > *:not(:last-child) {
        margin-bottom: 10px;
      }

      .status-messages-items > *:not(:last-child) {
        margin-right: 10px;
      }

      .status-messages-list,
      .status-messages-list-values {
        display: flex;
        align-items: flex-start;
        flex-direction: column;
        gap: 10px;
        justify-content: space-between;
      }

      .status-messages-items {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: flex-start;
        gap: 10px;
        margin: 0 50px 0 20px;
      }

      .log {
        height: 200px;
        overflow-y: auto;
        padding: 15px;
        margin-top: 20px;
        font-family: "Consolas", monospace;
        background-color: #363936;
        color: #e5e0e6;
        border-radius: 6px;
        line-height: 1.5;
      }

      /* Replace your current slider styles with these optimized versions */
      .slider {
        -webkit-appearance: none !important;
        appearance: none !important;
        height: 8px;
        background: #e5e0e6; /* Track color */
        border-radius: 5px;
        outline: none;
        margin: 15px 0;
        width: 100%;
        max-width: 200px;
        position: relative; /* Helps stabilize positioning */
        touch-action: none; /* Prevents scrolling while sliding */
        will-change: transform; /* Optimizes for animations */
      }

      /* Track styling for Chrome/Android */
      .slider::-webkit-slider-runnable-track {
        height: 8px;
        border-radius: 5px;
        background: #e5e0e6;
        border: none;
      }

      /* Thumb styling optimized for Chrome 83/Android 10 */
      .slider::-webkit-slider-thumb {
        -webkit-appearance: none !important;
        appearance: none !important;
        width: 28px;
        height: 28px;
        background: linear-gradient(135deg, #4c6a9c, #2f445c);
        border: 2px solid #e5e0e6;
        border-radius: 50% !important;
        margin-top: -10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3),
          0 0 0 2px rgba(229, 224, 230, 0.3);
        position: relative;
        z-index: 2;
        cursor: pointer;
      }

      /* Container styling to prevent layout shifts */
      .slider-container {
        display: flex;
        align-items: center;
        min-height: 40px; /* Fixed height prevents jumps */
        max-width: 100%;
        position: relative; /* Stabilizes positioning */
        overflow: visible;
      }

      .slider-value {
        min-width: 40px; /* Fixed width for percentage display */
        text-align: left;
        padding-left: 8px;
      }

      /* Container for all text elements */
      .battery-text-overlay {
        position: absolute;
        top: 60%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        width: 100%;
      }

      /* Adjust original percentage text */
      .power-status.overlay-text {
        margin-bottom: 5px;
        position: static;
        transform: none;
      }

      /* Style for the battery signals */
      /* Style for the battery signals */
      .battery-details {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 15px; /* Even more space */
      }

      .battery-signal {
        font-size: 14px;
        font-weight: bold;
        color: #e5e0e6;
        letter-spacing: 1px;
      }

      /* Settings button styling */
      .settings-btn {
        position: absolute;
        right: 20px;
        top: 20px;
        background: rgba(47, 68, 92, 0.5);
        border: 1px solid #e5e0e6;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        transition: all 0.2s ease;
        z-index: 10;
      }

      .settings-btn:hover {
        background: rgba(229, 224, 230, 0.2);
        transform: rotate(30deg);
      }

      .control-group {
        position: relative; /* Ensure proper positioning of settings button */
      }
      /* Older Android fallback styles */
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 24px;
        height: 24px;
        background: #2f445c;
        border: none;
        border-radius: 50%;
      }

      input[type="range"]::-moz-range-thumb {
        width: 28px;
        height: 28px;
        background: linear-gradient(135deg, #4c6a9c, #2f445c);
        border: 2px solid #e5e0e6;
        border-radius: 50%;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3),
          0 0 0 2px rgba(229, 224, 230, 0.3);
      }

      /* Support for IE */
      input[type="range"]::-ms-thumb {
        width: 24px;
        height: 24px;
        background: #2f445c;
        border: none;
        border-radius: 50%;
      }
      /* ------------------ BUTTONS ------------------ */
      button,
      .tab-button,
      .toggle-btn,
      .momentary-btn,
      .round-btn {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
        outline: none;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      button {
        background-color: #2f445c;
        color: white;
        padding: 10px 15px;
        margin: 5px;
        border-radius: 4px;
        font-weight: 500;
      }

      .toggle-btn:not(.round-btn):not(.pill-btn),
      .momentary-btn:not(.round-btn):not(.pill-btn) {
        background-color: #2f445c; /* Dark background for inactive state */
        color: #e5e0e6; /* Light text for inactive state */
        padding: 12px 24px;
        border-radius: 6px;
        font-weight: 500;
      }

      .toggle-btn:not(.round-btn):not(.pill-btn):hover,
      .momentary-btn:not(.round-btn):not(.pill-btn):hover {
        background-color: #3a5272; /* Slightly lighter dark blue for hover state */
      }

      .toggle-btn:not(.round-btn):not(.pill-btn).active,
      .momentary-btn:not(.round-btn):not(.pill-btn).active {
        background-color: #e5e0e6; /* Light background for active state */
        color: #2f445c; /* Dark text for active state */
      }

      .round-btn {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 0;
        margin: 12px;
        background-color: #2f445c;
        position: relative;
        overflow: hidden;
        border: 2px solid #e5e0e6;
      }

      .round-btn img.icon {
        width: 40px;
        height: 40px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        transition: transform 0.2s ease;
      }

      .round-btn.active {
        background-color: #e5e0e6;
        color: #2f445c;
        animation: gentle-pulse 2s infinite;
      }

      .button-grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        padding: 20px 0;
        margin-right: -20px;
        margin-bottom: -20px;
      }

      .button-grid > * {
        margin-right: 20px;
        margin-bottom: 20px;
      }

      /* Button icon toggling */
      .round-btn .icon.active,
      .round-btn .icon.inactive {
        display: none;
      }

      .round-btn .icon.inactive {
        display: block !important;
      }

      .round-btn.active .icon.active {
        display: block !important;
      }

      .round-btn.active .icon.inactive {
        display: none !important;
      }

      .round-btn.toggle-btn.active img,
      .round-btn.momentary-btn.active img {
        filter: none;
      }

      /* Hover & active states */
      button:hover,
      .round-btn:hover {
        transform: translateY(-3px);
        box-shadow: none;
      }

      button:active,
      button.active,
      .round-btn:active,
      .round-btn.active {
        transform: scale(0.96);
        box-shadow: none;
      }

      .button-1,
      .button-2,
      .button-3,
      .button-4,
      .button-5,
      .button-6,
      .button-7,
      .button-8 {
        display: flex;
        justify-content: center; /* horizontal centering of items */
        align-items: center; /* vertical centering of items */
        flex-direction: column;
      }

      .round-btn img.icon {
        -webkit-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
      }

      .round-btn img.icon {
        -webkit-transition: transform 0.2s ease;
        transition: transform 0.2s ease;
      }

      /* ------------------ TAB NAVIGATION ------------------ */
      .tab-navigation {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #2f445c;
        border-top: 2px solid #e5e0e6;
        margin: 0 30px;
        z-index: 1000;
      }

      .tab-button {
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100px;
        height: 100px;
        padding: 8px;
        background-color: transparent;
      }

      .tab-button .icon {
        width: 100px;
        height: 100px;
        transition: opacity 0.3s;
      }

      .tab-button .icon.active {
        display: none;
      }

      .tab-button .icon.inactive {
        display: block;
      }

      .tab-button.active .icon.active {
        display: block;
      }

      .tab-button.active .icon.inactive {
        display: none;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
        animation: fadeIn 0.3s;
      }

      /* Power tab styles */
      .power-controls-grid {
        display: flex;
        justify-content: space-between;
      }

      .power-controls-grid > div:not(:last-child) {
        margin-right: 50px;
      }

      .power-column {
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      .power-column > div:not(:last-child) {
        margin-bottom: 5px;
      }

      .power-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: rgba(47, 68, 92, 0.4);
        border-radius: 8px;
        text-align: center;
      }

      .power-label {
        text-align: left;
        width: 100%;
        border-bottom: 2px solid #e5e0e6;
      }

      .power-status {
        margin-top: 10px;
        color: #e5e0e6;
      }

      .battery-indicator {
        width: 80%;
        height: 25px;
        background-color: rgba(229, 224, 230, 0.2);
        border-radius: 12px;
        overflow: hidden;
        margin: 10px 0;
      }

      .battery-level {
        height: 100%;
        background-color: #4caf50;
        border-radius: 12px;
      }

      .power-value {
        font-size: 24px;
        font-weight: bold;
        color: #e5e0e6;
        margin: 15px 0;
      }

      /* Solar component styling */
      .solar-data {
        width: 100%;
        text-align: left;
      }

      .data-section {
        margin-bottom: 10px;
      }

      .data-section h4 {
        color: #e5e0e6;
        margin: 5px 0;
        font-size: 12px;
        font-weight: 500;
        text-transform: uppercase;
        text-decoration: underline;
      }

      .data-row {
        display: flex;
        justify-content: space-between;
        width: 100%;
        margin: 5px 0;
      }

      .data-label {
        text-align: left;
        font-size: 12px;
        letter-spacing: 1px;
      }

      .data-value {
        text-align: right;
        font-size: 12px;
        font-weight: bold;
        letter-spacing: 1px;
      }

      /* For appearance */
      .slider {
        -webkit-appearance: none;
        appearance: none;
        /* Existing properties... */
      }

      /* For animations */
      @-webkit-keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @-webkit-keyframes gentle-pulse {
        0% {
          -webkit-box-shadow: 0 0 0 0 rgba(47, 68, 92, 0.4);
        }
        70% {
          -webkit-box-shadow: 0 0 0 10px rgba(47, 68, 92, 0);
        }
        100% {
          -webkit-box-shadow: 0 0 0 0 rgba(47, 68, 92, 0);
        }
      }

      /* Add to all interactive elements */
      button,
      .tab-button,
      .round-btn,
      .toggle-btn,
      .momentary-btn,
      input[type="range"] {
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
      }

      /* Add to animated elements */
      .round-btn.active {
        will-change: transform, background-color;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
      }

      /* Optimize transitions */
      .tab-content.active {
        display: block;
        -webkit-animation: fadeIn 0.3s;
        animation: fadeIn 0.3s;
      }

      /* ------------------ ANIMATIONS ------------------ */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes gentle-pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(47, 68, 92, 0.4);
        }
        70% {
          box-shadow: 0 0 0 10px rgba(47, 68, 92, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(47, 68, 92, 0);
        }
      }

      /* Battery overlay styling */
      .battery-container {
        position: relative;
        display: flex; /* Use flexbox for centering */
        flex-direction: column; /* Stack children vertically */
        align-items: center; /* Center horizontally */
        justify-content: center; /* Center vertically */
        width: 100%; /* Take full width of parent */
        margin: 15px 0;
      }

      .battery-image {
        display: block;
        max-width: 75%;
        margin: 0 auto; /* Backup centering method */
      }

      .overlay-text {
        position: absolute;
        top: 45%;
        left: 50%;
        transform: translate(-50%, -50%);
        /* Other styles remain the same */
      }

      /* HVAC Tab Interface */
      .hvac-tabs {
        display: flex;
        border-bottom: 2px solid #e5e0e6;
        margin-bottom: 20px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      .hvac-tab-button {
        background-color: transparent;
        color: #e5e0e6;
        opacity: 0.5;
        border: none;
        padding: 5px 20px;
        font-size: 14px;
        font-weight: 500;
        letter-spacing: 1px;
        text-transform: uppercase;
        cursor: pointer;
        transition: all 0.2s ease;
        margin-top: 0px;
      }

      .hvac-tab-button.active {
        color: #fff;
        opacity: 1;
      }

      .hvac-tab-content {
        display: none;
      }

      .hvac-tab-content.active {
        display: block;
        animation: fadeIn 0.3s;
        -webkit-animation: fadeIn 0.3s;
      }

      .hvac-control-grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
      }

      .hvac-control-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 15px;
        background-color: rgba(47, 68, 92, 0.4);
        border-radius: 8px;
        width: 150px;
      }

      .hvac-label {
        color: #e5e0e6;
        margin-bottom: 15px;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 2px;
        text-transform: uppercase;
      }

      .hvac-status {
        color: #e5e0e6;
        margin-top: 10px;
      }

      /* Fan speed slider labels */
      .fan-speed-labels {
        display: flex;
        justify-content: space-between;
        width: 100%;
        margin-top: 5px;
      }

      .fan-speed-labels span {
        font-size: 10px;
        color: #e5e0e6;
        text-transform: none;
        letter-spacing: 0;
      }
      /* HVAC Container with Thermostat */
      .hvac-container {
        display: flex;
        flex-direction: row;
        gap: 20px;
      }

      .hvac-tabs-column {
        flex: 2; /* Takes up 2/3 of the space */
      }

      .thermostat-column {
        flex: 1; /* Takes up 1/3 of the space */
        max-height: 240px; /* Prevents overflow */
      }

      /* Thermostat Component */
      .thermostat {
        background-color: rgba(47, 68, 92, 0.4);
        border-radius: 8px;
        padding: 15px;
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100%;
        justify-content: center;
        gap: 15px;
      }

      .thermostat-title {
        margin-bottom: 5px;
      }

      .thermostat-display {
        margin: 10px 0;
      }

      .thermostat-controls {
        width: 100%;
        margin-top: 10px;
      }

      .current-temp {
        color: #e5e0e6;
        font-size: 48px;
        font-weight: 300;
        line-height: 1;
      }

      .temp-unit {
        color: #e5e0e6;
        font-size: 24px;
        margin-left: 5px;
      }

      .thermostat-btn {
        background-color: transparent;
        border: 1px solid #e5e0e6;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        padding: 0;
      }

      .thermostat-btn:hover {
        background-color: rgba(229, 224, 230, 0.1);
      }

      .set-temp {
        margin: 10px auto;
        color: #e5e0e6;
        font-size: 14px;
        text-align: center;
        width: 100%;
        display: block;
      }
      .temp-slider-container {
        width: 100%;
        margin: 10px auto;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .temp-slider {
        -webkit-appearance: none;
        appearance: none;
        height: 8px;
        background: #e5e0e6;
        border-radius: 5px;
        outline: none;
        width: 90%;
        max-width: 200px;
      }

      .power-status {
        font-size: 2rem;
      }

      .temp-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 24px;
        height: 24px;
        background: #2f445c;
        border: 2px solid #e5e0e6;
        border-radius: 50%;
        cursor: pointer;
      }

      .temp-slider::-moz-range-thumb {
        width: 24px;
        height: 24px;
        background: #2f445c;
        border: 2px solid #e5e0e6;
        border-radius: 50%;
        cursor: pointer;
      }

      /* Lighting tab styles */
      .lighting-container {
        display: flex;
        flex-direction: row;
        gap: 20px;
        margin-top: 20px;
      }

      .image-error {
        width: 100%;
        height: 180px;
        background-color: rgba(229, 224, 230, 0.1);
        border: 2px dashed rgba(229, 224, 230, 0.3);
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }

      .image-error::before {
        content: "Image not found";
        color: #e5e0e6;
        font-size: 14px;
        text-align: center;
      }

      .lighting-tabs-column {
        flex: 2; /* Takes up 2/3 of the space */
      }

      .lighting-image-column {
        flex: 1; /* Takes up 1/3 of the space */
      }

      .lighting-tabs {
        display: flex;
        border-bottom: 2px solid #e5e0e6;
        margin-bottom: 5px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      .lighting-tab-button {
        background-color: transparent;
        color: #e5e0e6;
        opacity: 0.5;
        border: none;
        padding: 5px 20px;
        font-size: 14px;
        font-weight: 500;
        letter-spacing: 1px;
        text-transform: uppercase;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .lighting-tab-button.active {
        color: #fff;
        opacity: 1;
      }

      .lighting-tab-content {
        display: none;
      }

      .lighting-tab-content.active {
        display: block;
        animation: fadeIn 0.3s;
        -webkit-animation: fadeIn 0.3s;
      }

      .lighting-control-grid {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        margin: 50px;
      }

      .lighting-control-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: left;
        background-color: rgba(47, 68, 92, 0.4);
        border-radius: 8px;
        width: 180px;
      }

      .lighting-label {
        color: #e5e0e6;
        margin-bottom: 5px;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 2px;
        text-transform: uppercase;
        width: 100%;
        text-align: left;
      }

      .lighting-status {
        color: #e5e0e6;
        margin-top: 10px;
      }

      .lighting-visualization {
        background-color: rgba(47, 68, 92, 0.4);
        border-radius: 8px;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100%;
        min-height: 200px;
        justify-content: space-between;
      }

      .lighting-image {
        max-width: 100%;
        height: auto;
        margin-bottom: 20px;
      }

      .lighting-mode-label {
        color: #e5e0e6;
        font-size: 14px;
        text-align: center;
      }

      /* Two-column layout for lighting controls */
      .lighting-control-grid.two-column {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 15px;
      }

      .lighting-column {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .lighting-column .lighting-control-item {
        width: auto;
        margin-bottom: 0;
      }

      /* Make lighting control items take full width of their container */
      .lighting-control-item {
        width: 100%;
      }

      .slider-group {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        margin: 10px auto;
        position: relative;
      }

      .slider-group .lighting-label {
        width: 100%;
        margin-bottom: 5px;
        text-align: left;
      }

      .slider-group .slider-container {
        margin-top: 5px;
        margin-bottom: 5px;
      }

      .warmth-slider {
        -webkit-appearance: none !important;
        appearance: none !important;
        height: 8px;
        background: #e5e0e6; /* Track color */
        border-radius: 5px;
        outline: none;
        margin: 15px 0;
        width: 100%;
        max-width: 200px;
        position: relative; /* Helps stabilize positioning */
        touch-action: none; /* Prevents scrolling while sliding */
        will-change: transform; /* Optimizes for animations */
      }

      .warmth-slider::-webkit-slider-thumb {
        -webkit-appearance: none !important;
        appearance: none !important;
        width: 28px;
        height: 28px;
        background: linear-gradient(135deg, #4c6a9c, #2f445c);
        border: 2px solid #e5e0e6;
        border-radius: 50% !important;
        margin-top: -10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3),
          0 0 0 2px rgba(229, 224, 230, 0.3);
        position: relative;
        z-index: 2;
        cursor: pointer;
      }

      .warmth-slider::-moz-range-thumb {
        width: 28px;
        height: 28px;
        background: linear-gradient(135deg, #4c6a9c, #2f445c);
        border: 2px solid #e5e0e6;
        border-radius: 50%;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3),
          0 0 0 2px rgba(229, 224, 230, 0.3);
        cursor: pointer;
      }

      /* Ensure slider containers are consistent */
      .slider-container {
        display: flex;
        align-items: center;
        justify-content: center; /* Center horizontally */
        min-height: 40px;
        width: 100%;
        margin: 10px auto; /* Add some vertical spacing and center */
        position: relative;
        overflow: visible;
      }

      /* Make sliders slightly smaller to fit well in the grid */
      .lighting-control-item .slider {
        max-width: none;
        width: 100%; /* Account for the percentage display */
      }

      .ext-btn {
        width: 48px;
        height: 48px;
      }

      .color-selector {
        margin-bottom: 15px;
        display: hidden;
      }

      .color-selector input[type="color"] {
        width: 60px;
        height: 60px;
        border: none;
        overflow: hidden;
        cursor: pointer;
        display: none;
      }

      .slider-value {
        color: #e5e0e6;
        font-size: 14px;
        margin-left: 10px;
      }

      /* Plumbing tab styles */
      .plumbing-container {
        display: flex;
        margin-top: 20px;
        gap: 20px;
      }

      /* Left column - buttons (1/5 width) */
      .plumbing-controls-column {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .plumbing-control-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 5px;
        background-color: rgba(47, 68, 92, 0.4);
        border-radius: 8px;
        text-align: center;
      }

      .plumbing-label {
        color: #e5e0e6;
        margin-bottom: 15px;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 2px;
        text-transform: uppercase;
      }

      .plumbing-status {
        color: #e5e0e6;
        margin-top: 10px;
      }

      /* Right column - tank gauges (4/5 width) */
      .plumbing-tanks-column {
        flex: 4;
        background-color: hsla(212, 32%, 27%, 0.4);
        border-radius: 8px;
        padding: 20px;
      }

      .tank-gauge-container {
        display: flex;
        justify-content: space-between;
        height: 300px;
        gap: 30px;
      }

      .tank-gauge-item {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
      }

      .tank-label {
        color: #e5e0e6;
        margin-bottom: 15px;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 2px;
        text-transform: uppercase;
      }

      .tank-percentage {
        color: #e5e0e6;
        font-size: 18px;
        margin-top: 10px;
        font-weight: bold;
      }

      /* Vertical tank gauge */
      .vertical-gauge-container {
        display: flex;
        height: 220px;
        width: 100%;
        position: relative;
      }

      .vertical-gauge {
        width: 40px;
        height: 100%;
        background-color: rgba(229, 224, 230, 0.1);
        border-radius: 20px;
        overflow: hidden;
        position: relative;
        margin: 0 auto;
      }

      .gauge-level {
        position: absolute;
        bottom: 0;
        width: 100%;
        background: linear-gradient(to top, #eeeaee, #eeeaee);
        border-radius: 20px;
        transition: height 0.5s ease;
      }

      /* Black and grey water tanks have different colors */
      .tank-gauge-item:nth-child(2) .gauge-level,
      .tank-gauge-item:nth-child(3) .gauge-level {
        background: linear-gradient(to top, #eeeaee, #eeeaee);
      }

      /* LPG tank has its own color */
      .tank-gauge-item:nth-child(4) .gauge-level {
        background: linear-gradient(to top, #eeeaee, #eeeaee);
      }

      .gauge-markers {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 100%;
        margin-left: 5px;
      }

      .gauge-markers span {
        font-size: 10px;
        color: #e5e0e6;
        position: relative;
        left: -15px; /* Adjust for positioning */
        letter-spacing: 0;
      }

      /* Pill Button Styles */
      .pill-btn {
        width: 150px;
        height: 30px;
        border-radius: 25px;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 0 20px;
        margin: 6px auto;
        background-color: #2f445c;
        position: relative;
        overflow: hidden;
        border: 2px solid #e5e0e6;
      }

      .pill-btn-content {
        display: flex;
        align-items: center;
        width: 100%;
        justify-content: center;
      }

      .pill-btn-icon {
        position: relative;
        width: 30px;
        height: 30px;
        margin-right: 10px;
      }

      .pill-btn-icon img.icon {
        width: 30px;
        height: 30px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }

      .pill-btn-text {
        color: #e5e0e6; /* Light color text on dark background when inactive */
        font-size: 10px; /* Fixed the typo in font-size */
        letter-spacing: 1px;
        text-transform: uppercase;
      }

      /* Active state - this targets the button itself */
      .pill-btn.active {
        background-color: #e5e0e6; /* Light background when active */
      }

      /* This targets the text inside an active button */
      .pill-btn.active .pill-btn-text {
        color: #2f445c; /* Dark color text on light background when active */
      }

      /* Icon behavior for toggle buttons */
      .pill-btn .icon.active,
      .pill-btn .icon.inactive {
        display: none;
      }

      .pill-btn .icon.inactive {
        display: block !important;
      }

      .pill-btn.active .icon.active {
        display: block !important;
      }

      .pill-btn.active .icon.inactive {
        display: none !important;
      }
      /* Value controls styling */
      .numeric-control {
        margin-top: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
      }

      .control-label {
        font-size: 12px;
        color: #e5e0e6;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .control-value-container {
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: rgba(47, 68, 92, 0.6);
        border-radius: 25px;
        padding: 5px 15px;
        width: 90%;
      }

      .control-value {
        color: #e5e0e6;
        font-size: 20px;
        margin: 0 15px;
        min-width: 30px;
        text-align: center;
      }

      .control-btn {
        background-color: transparent;
        border: 1px solid #e5e0e6;
        border-radius: 50%;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        padding: 0;
      }

      .control-btn:hover {
        background-color: rgba(229, 224, 230, 0.1);
      }

      /* Color preset buttons styling */
      .color-presets {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        margin: 10px 0;
      }

      .color-preset-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 2px solid #e5e0e6;
        cursor: pointer;
        transition: transform 0.2s;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      .color-preset-btn:hover {
        transform: scale(1.1);
      }

      .color-preset-btn.active {
        transform: scale(0.9);
        box-shadow: 0 0 0 3px rgba(229, 224, 230, 0.5);
      }

      .lighting-mode-buttons {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 15px;
      }
      /* RGB Zone tab navigation */
      .rgb-zone-tabs {
        display: flex;
        border-bottom: 2px solid #e5e0e6;
        margin-bottom: 15px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      .rgb-zone-button {
        background-color: transparent;
        color: #e5e0e6;
        opacity: 0.5;
        border: none;
        padding: 8px 15px;
        font-size: 12px;
        font-weight: 500;
        letter-spacing: 1px;
        text-transform: uppercase;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .rgb-zone-button.active {
        color: #fff;
        opacity: 1;
      }

      .rgb-zone-content {
        display: none;
      }

      .rgb-zone-content.active {
        display: block;
        animation: fadeIn 0.3s;
      }

      /* 2x2 Grid for MultiPlus buttons */
      .button-grid-2x2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        width: 100%;
        padding: 10px 0;
      }

      .button-grid-2x2 .pill-btn {
        margin: 0;
        width: auto;
      }

      /* Modal/Popup styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        width: 100vw;
        height: 100vh;
        background-color: rgba(0, 0, 0, 0.7);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        margin: 0;
        padding: 0;
      }

      .modal-content {
        background-color: #2f445c;
        border: 2px solid #e5e0e6;
        border-radius: 8px;
        width: 80%;
        max-width: 500px;
        color: #e5e0e6;
        animation: fadeIn 0.3s;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-left: 20px;
        border-bottom: 1px solid #e5e0e6;
      }

      .modal-header h3 {
        margin: 0;
        color: #e5e0e6;
      }

      .close-modal {
        background: transparent;
        border: none;
        font-size: 24px;
        color: #e5e0e6;
        cursor: pointer;
      }

      .pill-btn.disabled {
        opacity: 0.5;
        cursor: not-allowed;
        pointer-events: none;
      }

      .pill-btn.disabled .pill-btn-text {
        color: none;
      }

      .modal-body {
        padding: 20px;
      }

      .modal-footer {
        padding: 15px;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
        border-top: 1px solid #e5e0e6;
      }

      .limit-control {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .preset-limits {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
      }

      .preset-btn {
        width: auto !important;
        padding: 5px 15px;
      }

      .preset-btn.active {
        background-color: #e5e0e6;
        color: #2f445c;
      }

      .ac-limit-control {
        margin: 5px auto;
      }

      .ac-limit-control .unit {
        color: #e5e0e6;
        margin-right: 10px;
      }

      /* Color slider with dynamic background */
      .color-slider-container {
        position: relative;
        margin-top: 15px;
      }

      /* works in every evergreen browser */
      .color-slider {
        appearance: none; /* remove default styling            */
        width: 100%;
        height: 10px;
        border-radius: 5px;
        background: linear-gradient(
          to right,
          #ff0000 0%,
          /* red     */ #ffff00 17%,
          /* yellow  */ #00ff00 33%,
          /* lime    */ #00ffff 50%,
          /* cyan    */ #0000ff 67%,
          /* blue    */ #ff00ff 83%,
          /* magenta */ #ff0000 100% /* back to red so it wraps */
        );
        outline: none;
        cursor: pointer;
      }

      /* WebKit/Blink thumb */
      .color-slider::-webkit-slider-thumb {
        -webkit-appearance: none !important;
        appearance: none !important;
        width: 28px;
        height: 28px;
        background: linear-gradient(135deg, #4c6a9c, #2f445c);
        border: 2px solid #e5e0e6;
        border-radius: 50% !important;
        margin-top: -10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3),
          0 0 0 2px rgba(229, 224, 230, 0.3);
        position: relative;
        z-index: 2;
        cursor: pointer;
      }

      /* Firefox thumb */
      .color-slider::-moz-range-thumb {
        width: 28px;
        height: 28px;
        background: linear-gradient(135deg, #4c6a9c, #2f445c);
        border: 2px solid #e5e0e6;
        border-radius: 50%;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3),
          0 0 0 2px rgba(229, 224, 230, 0.3);
        cursor: pointer;
      }

      .color-slider::-webkit-slider-thumb {
        border: 2px solid white;
      }

      /* Mode toggle buttons layout */
      .mode-toggle {
        display: flex;
        flex-direction: column; /* Change from row (default) to column */
        gap: 10px;
        margin: 10px 0;
        align-items: center; /* Center the buttons horizontally within the container */
      }

      /* You may want to adjust the width for consistency */
      .mode-toggle .pill-btn {
        width: 150px; /* Make buttons a consistent width */
      }

      /* Toggle Switch Styling */
      .toggle-switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 30px;
        margin: 10px auto;
      }

      .toggle-switch-input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .toggle-switch-slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #2f445c;
        border: 2px solid #e5e0e6;
        transition: 0.4s;
        border-radius: 34px;
      }

      .toggle-switch-slider:before {
        position: absolute;
        content: "";
        height: 22px;
        width: 22px;
        left: 2px;
        bottom: 2px;
        background-color: #e5e0e6;
        transition: 0.4s;
        border-radius: 50%;
      }

      .toggle-switch-input:checked + .toggle-switch-slider {
        background-color: #e5e0e6;
      }

      .toggle-switch-input:checked + .toggle-switch-slider:before {
        transform: translateX(26px);
        background-color: #2f445c;
      }

      /* Responsive adjustments */
    </style>
  </head>

  <body>
    <div class="header">
      <div class="temps">
        <span class="temp-value">Interior: 72°F</span>
        <span class="temp-value">Exterior: 65°F</span>
      </div>
      <div class="time-to-go">
        <span class="time-value">Time To Go: 3:42</span>
      </div>
    </div>
    <!-- Settings Modal Template -->
    <div class="modal-overlay settings-modal" id="settings-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="settings-title">Settings</h3>
          <button class="close-modal">&times;</button>
        </div>
        <div class="modal-body" id="settings-content">
          <!-- Content will be dynamically inserted here -->
        </div>
        <div class="modal-footer">
          <button class="pill-btn" id="cancel-settings">Cancel</button>
          <button class="pill-btn" id="save-settings">Save</button>
        </div>
      </div>
    </div>
    <div class="tab-content active" id="connection-tab">
      <div class="home-page">
        <div class="status-messages">
          <h2>Status</h2>
          <div class="status-messages-items">
            <div class="status-messages-list">
              <span class="status-house-battery">HOUSE BATTERY</span>
              <span class="status-house-battery">Charge Source</span>
              <span class="status-house-battery">Power Consumption</span>
              <span class="status-house-battery">Charge Power</span>
            </div>
            <div class="status-messages-list-values">
              <span class="status-house-battery">100%</span>
              <span class="status-charge-source">Solar</span>
              <span class="status-power-consumption">50W</span>
              <span class="status-power-consumption">125W</span>
            </div>
          </div>
        </div>
        <div class="button-grid">
          <div class="button-1">
            <span class="button-1-label">Button 1</span>
            <button class="round-btn toggle-btn" data-id="1">
              <img
                src="images/icons/1-white.png"
                class="icon inactive"
                alt="Icon"
              />
              <img
                src="images/icons/1-black.png"
                class="icon active"
                alt="Icon Active"
              />
            </button>
          </div>
          <div class="button-2">
            <span class="button-2-label">Button 2</span>
            <button class="round-btn toggle-btn" data-id="4">
              <img
                src="images/icons/2-white.png"
                class="icon inactive"
                alt="HVAC"
              />
              <img
                src="images/icons/2-black.png"
                class="icon active"
                alt="HVAC Active"
              />
            </button>
          </div>
          <div class="button-3">
            <span class="button-3-label">Button 3</span>
            <button class="round-btn toggle-btn" data-id="1">
              <img
                src="images/icons/3-white.png"
                class="icon inactive"
                alt="Icon"
              />
              <img
                src="images/icons/3-black.png"
                class="icon active"
                alt="Icon Active"
              />
            </button>
          </div>
          <div class="button-4">
            <span class="button-4-label">Button 4</span>
            <button class="round-btn toggle-btn" data-id="4">
              <img
                src="images/icons/4-white.png"
                class="icon inactive"
                alt="HVAC"
              />
              <img
                src="images/icons/4-black.png"
                class="icon active"
                alt="HVAC Active"
              />
            </button>
          </div>
          <div class="button-5">
            <span class="button-5-label">Button 5</span>
            <button class="round-btn toggle-btn" data-id="1">
              <img
                src="images/icons/5-white.png"
                class="icon inactive"
                alt="Icon"
              />
              <img
                src="images/icons/5-black.png"
                class="icon active"
                alt="Icon Active"
              />
            </button>
          </div>
          <div class="button-6">
            <span class="button-6-label">Button 6</span>
            <button class="round-btn toggle-btn" data-id="4">
              <img
                src="images/icons/6-white.png"
                class="icon inactive"
                alt="HVAC"
              />
              <img
                src="images/icons/6-black.png"
                class="icon active"
                alt="HVAC Active"
              />
            </button>
          </div>
          <div class="button-7">
            <span class="button-7-label">Button 7</span>
            <button class="round-btn toggle-btn" data-id="4">
              <img
                src="images/icons/7-white.png"
                class="icon inactive"
                alt="HVAC"
              />
              <img
                src="images/icons/7-black.png"
                class="icon active"
                alt="HVAC Active"
              />
            </button>
          </div>
          <div class="button-8">
            <span class="button-8-label">Button 8</span>
            <button class="round-btn toggle-btn" data-id="4">
              <img
                src="images/icons/8-white.png"
                class="icon inactive"
                alt="HVAC"
              />
              <img
                src="images/icons/8-black.png"
                class="icon active"
                alt="HVAC Active"
              />
            </button>
          </div>
        </div>
      </div>

      <div class="control-group" style="display: none">
        <h2>Connection</h2>
        <div>
          <label for="ws-host">Host:</label>
          <input type="text" id="ws-host" value="172.16.11.7" />

          <label for="ws-port">Port:</label>
          <input type="text" id="ws-port" value="8888" />

          <button id="connect-btn">Connect</button>
          <button id="disconnect-btn">Disconnect</button>
          <div id="connection-status" class="connection-status disconnected">
            Disconnected
          </div>
        </div>
      </div>
    </div>

    <!-- Power tab -->
    <div class="tab-content" id="toggle-tab">
      <div class="control-group">
        <div class="power-controls-grid">
          <!-- Column 1 -->
          <div class="power-column">
            <div class="power-item">
              <h2 class="power-label">Solar</h2>
              <div class="solar-data">
                <div class="data-section">
                  <h4>Primary</h4>
                  <div class="data-row">
                    <span class="data-label">Amperage:</span>
                    <span class="data-value">0.1A</span>
                  </div>
                  <div class="data-row">
                    <span class="data-label">Voltage:</span>
                    <span class="data-value">13.57V</span>
                  </div>
                </div>
                <div class="data-section">
                  <h4>Auxiliary</h4>
                  <div class="data-row">
                    <span class="data-label">Amperage:</span>
                    <span class="data-value">0.1A</span>
                  </div>
                  <div class="data-row">
                    <span class="data-label">Voltage:</span>
                    <span class="data-value">13.57V</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Column 2 -->
          <div class="power-column">
            <div class="power-item">
              <div class="battery-container">
                <img
                  class="battery-image"
                  src="images/Isolation_Mode.png"
                  alt="Battery"
                />
                <div class="battery-text-overlay">
                  <h2 class="power-status overlay-text">75%</h2>
                  <div class="battery-details">
                    <span class="battery-signal">12.6V</span>
                    <span class="battery-signal">2.4A</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="power-item">
              <h2 class="power-label">MultiPlus</h2>
              <div class="button-grid-2x2">
                <button
                  class="pill-btn toggle-btn multiplus-btn"
                  data-id="12"
                  data-mode="on"
                >
                  <div class="pill-btn-content">
                    <span class="pill-btn-text">On</span>
                  </div>
                </button>
                <button
                  class="pill-btn toggle-btn multiplus-btn"
                  data-id="12"
                  data-mode="off"
                >
                  <div class="pill-btn-content">
                    <span class="pill-btn-text">Off</span>
                  </div>
                </button>
                <button
                  class="pill-btn toggle-btn multiplus-btn"
                  data-id="12"
                  data-mode="charger"
                >
                  <div class="pill-btn-content">
                    <span class="pill-btn-text">Charger Only</span>
                  </div>
                </button>
               
              </div>
            </div>
          </div>
          <!-- AC Limit Popup -->
          <div class="modal-overlay" id="ac-limit-modal">
            <div class="modal-content">
              <div class="modal-header">
                <h3>Set AC Input Limit</h3>
                <button class="close-modal">&times;</button>
              </div>
              <div class="modal-body">
                <div class="limit-control">
                  <span class="control-label">Shore Current Limit:</span>
                  <div class="control-value-container ac-limit-control">
                    <button class="control-btn" id="ac-limit-down">
                      <svg width="16" height="16" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" fill="#e5e0e6" />
                      </svg>
                    </button>
                    <span class="control-value" id="ac-limit-value">30</span>
                    <span class="unit">A</span>
                    <button class="control-btn" id="ac-limit-up">
                      <svg width="16" height="16" viewBox="0 0 24 24">
                        <path d="M7 14l5-5 5 5z" fill="#e5e0e6" />
                      </svg>
                    </button>
                  </div>
                  <div class="preset-limits">
                    <button class="pill-btn preset-btn" data-value="10">
                      10A
                    </button>
                    <button class="pill-btn preset-btn" data-value="15">
                      15A
                    </button>
                    <button class="pill-btn preset-btn" data-value="20">
                      20A
                    </button>
                    <button class="pill-btn preset-btn" data-value="30">
                      30A
                    </button>
                    <button class="pill-btn preset-btn" data-value="50">
                      50A
                    </button>
                    <button class="pill-btn preset-btn" data-value="100">
                      100A
                    </button>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button class="pill-btn" id="cancel-limit">Cancel</button>
                <button class="pill-btn" id="apply-limit">Set</button>
              </div>
            </div>
          </div>

          <!-- Column 3 -->
          <div class="power-column">
            <!-- AC Loads -->
            <div class="power-item">
              <h2 class="power-label">AC Loads</h2>
              <div class="solar-data">
                <div class="data-section">
                  <div class="data-row">
                    <span class="data-label">Current:</span>
                    <span class="data-value">1.5A</span>
                  </div>
                  <div class="data-row">
                    <span class="data-label">Voltage:</span>
                    <span class="data-value">230V</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- DC Loads -->
            <div class="power-item">
              <h2 class="power-label">DC Loads</h2>
              <div class="solar-data">
                <div class="data-section">
                  <div class="data-row">
                    <span class="data-label">Current:</span>
                    <span class="data-value">10.0A</span>
                  </div>
                  <div class="data-row">
                    <span class="data-label">Voltage:</span>
                    <span class="data-value">12.0V</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="power-item">
              <h2 class="power-label">Shore Power</h2>
              <div class="solar-data">
                <div class="data-section">
                  <div class="data-row">
                    <span class="data-label">Amperage:</span>
                    <span class="data-value">0.0A</span>
                  </div>
                  <div class="data-row">
                    <span class="data-label">Voltage:</span>
                    <span class="data-value">0.0V</span>
                  </div>
                </div>
              </div>
              <button
                  class="pill-btn"
                  data-id="12"
                  id="ac-limit-btn"
                >
                  <div class="pill-btn-content">
                    <span class="pill-btn-text">AC Limit</span>
                  </div>
                </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- HVAC tab -->
    <div class="tab-content" id="momentary-tab">
      <div class="control-group">
        <div class="hvac-container">
          <!-- ▸ LEFT 2/3 – Tabs & panels -->
          <div class="hvac-tabs-column">
            <!-- Sub‑tab navigation -->
            <div class="hvac-tabs">
              <button class="hvac-tab-button active" data-hvac-tab="cooling">
                Hydronic
              </button>
              <button class="hvac-tab-button" data-hvac-tab="heating">
                AC
              </button>
              <button class="hvac-tab-button" data-hvac-tab="ventilation">
                Ventilation
              </button>
            </div>

            <!-- Tab panels -->
            <div class="hvac-tab-panels">
              <!-- Cooling / Hydronic -->
              <div class="hvac-tab-content active" id="cooling-tab">
                <div class="hvac-control-grid">
                  <!-- Column 1: Mode Controls -->
                  <div class="hvac-control-item">
                    <button class="pill-btn toggle-btn" data-id="20">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Hot Water</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="21">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Aux Zone</span>
                      </div>
                    </button>
                  </div>

                  <!-- Column 2: Fan Controls -->
                  <div class="hvac-control-item">
                    <button class="pill-btn toggle-btn" data-id="30">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Furnace</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="31">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Electric</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="32">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Engine</span>
                      </div>
                    </button>
                  </div>

                  <!-- Column 3: Extra Controls -->
                  <div class="hvac-control-item">
                    <button class="pill-btn toggle-btn" data-id="40">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Floor</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="41">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Fan</span>
                      </div>
                    </button>
                    <div class="numeric-control">
                      <span class="control-label">Fan Speed</span>
                      <div class="control-value-container">
                        <button class="control-btn" id="fan-speed-down">
                          <svg width="16" height="16" viewBox="0 0 24 24">
                            <path d="M7 10l5 5 5-5z" fill="#e5e0e6" />
                          </svg>
                        </button>
                        <span class="control-value" id="fan-speed-value"
                          >30%</span
                        >
                        <button class="control-btn" id="fan-speed-up">
                          <svg width="16" height="16" viewBox="0 0 24 24">
                            <path d="M7 14l5-5 5 5z" fill="#e5e0e6" />
                          </svg>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Heating -->
              <div class="hvac-tab-content" id="heating-tab">
                <div class="hvac-control-grid">
                  <!-- Column 1: Primary Heating Controls -->
                  <div class="hvac-control-item">
                    <button class="pill-btn toggle-btn" data-id="24">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Off</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="89">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Cool</span>
                      </div>
                    </button>

                    <button class="pill-btn toggle-btn" data-id="23">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Heat Pump</span>
                      </div>
                    </button>
                  </div>

                  <!-- Column 2: Auxiliary Heating Controls -->
                  <div class="hvac-control-item">
                    <button class="pill-btn toggle-btn" data-id="22">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Fan Only</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="25">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Low</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="26">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Medium</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="27">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">High</span>
                      </div>
                    </button>
                  </div>
                </div>
              </div>

              <div class="hvac-tab-content" id="ventilation-tab">
                <div class="hvac-control-grid">
                  <!-- Column 1: Vent Fan Controls -->
                  <div class="hvac-control-item">
                    <button class="pill-btn toggle-btn" data-id="60">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">On/Off</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="61">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Intake</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="62">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Exhaust</span>
                      </div>
                    </button>

                    <!-- Fan Speed Value Control -->
                    <div class="numeric-control">
                      <span class="control-label">Fan Speed</span>
                      <div class="control-value-container">
                        <button class="control-btn" id="vent-fan-down">
                          <svg width="16" height="16" viewBox="0 0 24 24">
                            <path d="M7 10l5 5 5-5z" fill="#e5e0e6" />
                          </svg>
                        </button>
                        <span class="control-value" id="vent-fan-value"
                          >30%</span
                        >
                        <button class="control-btn" id="vent-fan-up">
                          <svg width="16" height="16" viewBox="0 0 24 24">
                            <path d="M7 14l5-5 5 5z" fill="#e5e0e6" />
                          </svg>
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Column 2: Ventilation Modes -->
                  <div class="hvac-control-item">
                    <button class="pill-btn toggle-btn" data-id="65">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">On/Off</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="66">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Intake</span>
                      </div>
                    </button>
                    <button class="pill-btn toggle-btn" data-id="67">
                      <div class="pill-btn-content">
                        <span class="pill-btn-text">Exhaust</span>
                      </div>
                    </button>

                    <!-- Timer Value Control -->
                    <div class="numeric-control">
                      <span class="control-label">Fan Speed</span>
                      <div class="control-value-container">
                        <button class="control-btn" id="vent-fan2-down">
                          <svg width="16" height="16" viewBox="0 0 24 24">
                            <path d="M7 10l5 5 5-5z" fill="#e5e0e6" />
                          </svg>
                        </button>
                        <span class="control-value" id="vent-fan2-value"
                          >30%</span
                        >
                        <button class="control-btn" id="vent-fan2-up">
                          <svg width="16" height="16" viewBox="0 0 24 24">
                            <path d="M7 14l5-5 5 5z" fill="#e5e0e6" />
                          </svg>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- /.hvac-tab-panels -->
          </div>
          <!-- /.hvac-tabs-column -->

          <!-- ▸ RIGHT 1/3 – Thermostat -->
          <div class="thermostat-column">
            <div class="thermostat">
              <span class="thermostat-title">Temperature</span>

              <div class="thermostat-display">
                <span class="current-temp">72°</span>
                <span class="temp-unit">F</span>
              </div>

              <div class="thermostat-controls">
                <div class="set-temp">
                  <span>Set to: </span><span id="target-temp">74°F</span>
                </div>

                <div class="slider-container temp-slider-container">
                  <input
                    type="range"
                    id="temp-slider"
                    class="slider temp-slider"
                    min="60"
                    max="90"
                    value="74"
                    step="1"
                  />
                </div>
              </div>
            </div>
            <!-- /.thermostat -->
          </div>
          <!-- /.thermostat-column -->
        </div>
        <!-- /.hvac-container -->
      </div>
      <!-- /.control-group -->
    </div>
    <!-- /.tab-content -->
    <!-- ========================================================= -->
    <!-- LIGHTING TAB WITH SUB‑TABS, PANELS, AND IMAGE (CLEANED)  -->
    <!-- ========================================================= -->
    <div class="tab-content" id="slider-tab">
      <div class="control-group">
        <div class="lighting-container">
          <!-- ----------------------------------------------------- -->
          <!-- LEFT 2/3 — TABS & PANELS                              -->
          <!-- ----------------------------------------------------- -->
          <div class="lighting-tabs-column">
            <!-- Sub‑tab navigation -->
            <div class="lighting-tabs">
              <button
                class="lighting-tab-button active"
                data-lighting-tab="interior"
              >
                Interior
              </button>
              <button class="lighting-tab-button" data-lighting-tab="exterior">
                Exterior
              </button>
              <button class="lighting-tab-button" data-lighting-tab="rgb">
                RGB
              </button>
            </div>

            <!-- --------------------------------------------------- -->
            <!-- TAB PANELS (Interior • Exterior • RGB)              -->
            <!-- --------------------------------------------------- -->
            <div class="lighting-tab-panels">
              <!-- =============== INTERIOR =============== -->
              <div class="lighting-tab-content active" id="interior-tab">
                <div class="lighting-control-grid two-column">
                  <!-- Column 1 -->
                  <div class="lighting-column">
                    <!-- Main Cabin -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Main Cabin</span>
                      <div class="slider-container">
                        <input
                          type="range"
                          id="interior-main"
                          class="slider"
                          min="0"
                          max="100"
                          value="50"
                        />
                        <span class="slider-value">50%</span>
                      </div>
                    </div>
                    <!-- Reading Lights -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Reading Lights</span>
                      <div class="slider-container">
                        <input
                          type="range"
                          id="interior-reading"
                          class="slider"
                          min="0"
                          max="100"
                          value="70"
                        />
                        <span class="slider-value">70%</span>
                      </div>
                    </div>
                    <!-- Accent Lights -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Accent Lights</span>
                      <div class="slider-container">
                        <input
                          type="range"
                          id="interior-accent"
                          class="slider"
                          min="0"
                          max="100"
                          value="30"
                        />
                        <span class="slider-value">30%</span>
                      </div>
                    </div>
                  </div>

                  <!-- Column 2 -->
                  <div class="lighting-column">
                    <!-- Galley -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Galley</span>
                      <div class="slider-container">
                        <input
                          type="range"
                          id="interior-galley"
                          class="slider"
                          min="0"
                          max="100"
                          value="80"
                        />
                        <span class="slider-value">80%</span>
                      </div>
                    </div>
                    <!-- Bathroom -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Bathroom</span>
                      <div class="slider-container">
                        <input
                          type="range"
                          id="interior-bathroom"
                          class="slider"
                          min="0"
                          max="100"
                          value="60"
                        />
                        <span class="slider-value">60%</span>
                      </div>
                    </div>
                    <!-- Bedroom -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Bedroom</span>
                      <div class="slider-container">
                        <input
                          type="range"
                          id="interior-bedroom"
                          class="slider"
                          min="0"
                          max="100"
                          value="40"
                        />
                        <span class="slider-value">40%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- =============== EXTERIOR =============== -->
              <div class="lighting-tab-content" id="exterior-tab">
                <div class="lighting-control-grid two-column">
                  <!-- Column 1 -->
                  <div class="lighting-column">
                    <!-- Awning -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Awning</span>
                      <div class="slider-container">
                        <input
                          type="range"
                          id="exterior-awning"
                          class="slider"
                          min="0"
                          max="100"
                          value="80"
                        />
                        <span class="slider-value">80%</span>
                      </div>
                    </div>
                    <!-- Entry Light -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Entry Light</span>
                      <label class="toggle-switch">
                        <input
                          type="checkbox"
                          class="toggle-switch-input"
                          data-id="31"
                        />
                        <span class="toggle-switch-slider"></span>
                      </label>
                    </div>
                  </div>

                  <!-- Column 2 -->
                  <div class="lighting-column">
                    <!-- Security -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Security</span>
                      <label class="toggle-switch">
                        <input
                          type="checkbox"
                          class="toggle-switch-input"
                          data-id="30"
                        />
                        <span class="toggle-switch-slider"></span>
                      </label>
                    </div>
                    <!-- Accent Strip -->
                    <div class="lighting-control-item">
                      <span class="lighting-label">Accent Strip</span>
                      <div class="slider-container">
                        <input
                          type="range"
                          id="exterior-accent"
                          class="slider"
                          min="0"
                          max="100"
                          value="60"
                        />
                        <span class="slider-value">60%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- =============== RGB (4 ZONES) =============== -->
              <div class="lighting-tab-content" id="rgb-tab">
                <div class="rgb-zone-tabs">
                  <button class="rgb-zone-button active" data-zone-tab="zone1">
                    Zone 1
                  </button>
                  <button class="rgb-zone-button" data-zone-tab="zone2">
                    Zone 2
                  </button>
                  <button class="rgb-zone-button" data-zone-tab="zone3">
                    Zone 3
                  </button>
                  <button class="rgb-zone-button" data-zone-tab="zone4">
                    Zone 4
                  </button>
                </div>

                <div class="rgb-zone-panels">
                  <!-- ZONE 1 -->
                  <div class="rgb-zone-content" id="zone1-tab">
                    <div class="lighting-control-grid two-column">
                      <div class="lighting-column">
                        <div class="lighting-control-item">
                          <div class="mode-toggle">
                            <button
                              class="pill-btn toggle-btn mode-btn active"
                              data-mode="rgb"
                              data-zone="1"
                            >
                              <div class="pill-btn-content">
                                <span class="pill-btn-text">RGB</span>
                              </div>
                            </button>
                            <button
                              class="pill-btn toggle-btn mode-btn"
                              data-mode="white"
                              data-zone="1"
                            >
                              <div class="pill-btn-content">
                                <span class="pill-btn-text">White</span>
                              </div>
                            </button>
                          </div>
                          <div class="color-selector">
                            <input
                              type="color"
                              id="rgb-color-zone1"
                              value="#ff5500"
                              class="zone-color-picker"
                              data-zone="1"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="lighting-column">
                        <div class="lighting-control-item">
                          <span class="lighting-label">Brightness</span>
                          <div class="slider-container">
                            <input
                              type="range"
                              id="brightness-zone1"
                              class="slider"
                              min="0"
                              max="100"
                              value="60"
                              data-zone="1"
                            />
                            <span class="slider-value">60%</span>
                          </div>
                          <div class="slider-group" data-slider-type="rgb">
                            <span class="lighting-label">Color</span>
                            <div
                              class="slider-container color-slider-container"
                            >
                              <input
                                type="range"
                                id="hue-zone1"
                                class="slider color-slider"
                                min="0"
                                max="359"
                                value="20"
                                data-zone="1"
                              />
                            </div>
                          </div>
                          <div
                            class="slider-group"
                            data-slider-type="white"
                            style="display: none"
                          >
                            <span class="lighting-label">Warmth</span>
                            <div
                              class="slider-container warmth-slider-container"
                            >
                              <input
                                type="range"
                                id="warmth-zone1"
                                class="slider warmth-slider"
                                min="2700"
                                max="6500"
                                value="4600"
                                data-zone="1"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- ZONE 2 -->
                  <div class="rgb-zone-content" id="zone2-tab">
                    <div class="lighting-control-grid two-column">
                      <div class="lighting-column">
                        <div class="lighting-control-item">
                          <div class="mode-toggle">
                            <button
                              class="pill-btn toggle-btn mode-btn active"
                              data-mode="rgb"
                              data-zone="2"
                            >
                              <div class="pill-btn-content">
                                <span class="pill-btn-text">RGB</span>
                              </div>
                            </button>
                            <button
                              class="pill-btn toggle-btn mode-btn"
                              data-mode="white"
                              data-zone="2"
                            >
                              <div class="pill-btn-content">
                                <span class="pill-btn-text">White</span>
                              </div>
                            </button>
                          </div>
                          <div class="color-selector">
                            <input
                              type="color"
                              id="rgb-color-zone2"
                              value="#ff5500"
                              class="zone-color-picker"
                              data-zone="2"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="lighting-column">
                        <div class="lighting-control-item">
                          <span class="lighting-label">Brightness</span>
                          <div class="slider-container">
                            <input
                              type="range"
                              id="brightness-zone2"
                              class="slider"
                              min="0"
                              max="100"
                              value="60"
                              data-zone="2"
                            />
                            <span class="slider-value">60%</span>
                          </div>
                          <div class="slider-group" data-slider-type="rgb">
                            <span class="lighting-label">Color</span>
                            <div
                              class="slider-container color-slider-container"
                            >
                              <input
                                type="range"
                                id="hue-zone2"
                                class="slider color-slider"
                                min="0"
                                max="359"
                                value="20"
                                data-zone="2"
                              />
                            </div>
                          </div>
                          <div
                            class="slider-group"
                            data-slider-type="white"
                            style="display: none"
                          >
                            <span class="lighting-label">Warmth</span>
                            <div
                              class="slider-container warmth-slider-container"
                            >
                              <input
                                type="range"
                                id="warmth-zone2"
                                class="slider warmth-slider"
                                min="2700"
                                max="6500"
                                value="4600"
                                data-zone="2"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- ZONE 3 -->
                  <div class="rgb-zone-content" id="zone3-tab">
                    <div class="lighting-control-grid two-column">
                      <div class="lighting-column">
                        <div class="lighting-control-item">
                          <div class="mode-toggle">
                            <button
                              class="pill-btn toggle-btn mode-btn active"
                              data-mode="rgb"
                              data-zone="3"
                            >
                              <div class="pill-btn-content">
                                <span class="pill-btn-text">RGB</span>
                              </div>
                            </button>
                            <button
                              class="pill-btn toggle-btn mode-btn"
                              data-mode="white"
                              data-zone="3"
                            >
                              <div class="pill-btn-content">
                                <span class="pill-btn-text">White</span>
                              </div>
                            </button>
                          </div>
                          <div class="color-selector">
                            <input
                              type="color"
                              id="rgb-color-zone3"
                              value="#ff5500"
                              class="zone-color-picker"
                              data-zone="3"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="lighting-column">
                        <div class="lighting-control-item">
                          <span class="lighting-label">Brightness</span>
                          <div class="slider-container">
                            <input
                              type="range"
                              id="brightness-zone3"
                              class="slider"
                              min="0"
                              max="100"
                              value="60"
                              data-zone="3"
                            />
                            <span class="slider-value">60%</span>
                          </div>
                          <div class="slider-group" data-slider-type="rgb">
                            <span class="lighting-label">Color</span>
                            <div
                              class="slider-container color-slider-container"
                            >
                              <input
                                type="range"
                                id="hue-zone3"
                                class="slider color-slider"
                                min="0"
                                max="359"
                                value="20"
                                data-zone="3"
                              />
                            </div>
                          </div>
                          <div
                            class="slider-group"
                            data-slider-type="white"
                            style="display: none"
                          >
                            <span class="lighting-label">Warmth</span>
                            <div
                              class="slider-container warmth-slider-container"
                            >
                              <input
                                type="range"
                                id="warmth-zone3"
                                class="slider warmth-slider"
                                min="2700"
                                max="6500"
                                value="4600"
                                data-zone="3"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- ZONE 4 -->
                  <div class="rgb-zone-content" id="zone4-tab">
                    <div class="lighting-control-grid two-column">
                      <div class="lighting-column">
                        <div class="lighting-control-item">
                          <div class="mode-toggle">
                            <button
                              class="pill-btn toggle-btn mode-btn active"
                              data-mode="rgb"
                              data-zone="4"
                            >
                              <div class="pill-btn-content">
                                <span class="pill-btn-text">RGB</span>
                              </div>
                            </button>
                            <button
                              class="pill-btn toggle-btn mode-btn"
                              data-mode="white"
                              data-zone="4"
                            >
                              <div class="pill-btn-content">
                                <span class="pill-btn-text">White</span>
                              </div>
                            </button>
                          </div>
                          <div class="color-selector">
                            <input
                              type="color"
                              id="rgb-color-zone4"
                              value="#ff5500"
                              class="zone-color-picker"
                              data-zone="4"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="lighting-column">
                        <div class="lighting-control-item">
                          <span class="lighting-label">Brightness</span>
                          <div class="slider-container">
                            <input
                              type="range"
                              id="brightness-zone4"
                              class="slider"
                              min="0"
                              max="100"
                              value="60"
                              data-zone="4"
                            />
                            <span class="slider-value">60%</span>
                          </div>
                          <div class="slider-group" data-slider-type="rgb">
                            <span class="lighting-label">Color</span>
                            <div
                              class="slider-container color-slider-container"
                            >
                              <input
                                type="range"
                                id="hue-zone4"
                                class="slider color-slider"
                                min="0"
                                max="359"
                                value="20"
                                data-zone="4"
                              />
                            </div>
                          </div>
                          <div
                            class="slider-group"
                            data-slider-type="white"
                            style="display: none"
                          >
                            <span class="lighting-label">Warmth</span>
                            <div
                              class="slider-container warmth-slider-container"
                            >
                              <input
                                type="range"
                                id="warmth-zone4"
                                class="slider warmth-slider"
                                min="2700"
                                max="6500"
                                value="4600"
                                data-zone="4"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /#zone4-tab -->
                </div>
                <!-- /.rgb-zone-panels -->
              </div>
              <!-- /#rgb-tab -->
            </div>
            <!-- /.lighting-tab-panels -->
          </div>
          <!-- /.lighting-tabs-column -->

          <!-- RIGHT 1/3 — Static Image -->
          <div class="lighting-image-column">
            <div class="lighting-visualization">
              <img
                src="images/garminDisplayExtLtsReference 3.png"
                alt="Lighting Visualization"
                class="lighting-image"
                onerror="this.onerror=null; this.src='images/lighting-placeholder.png'; this.classList.add('image-error');"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Plumbing tab -->
    <div class="tab-content" id="logs-tab">
      <div class="control-group">
        <div class="plumbing-container">
          <!-- Left column - 1/5 width -->
          <div class="plumbing-controls-column">
            <div class="plumbing-control-item">
              <span class="plumbing-label">Water Pump</span>
              <button class="round-btn toggle-btn" data-id="50">
                <img
                  src="images/icons/18-white.png"
                  class="icon inactive"
                  alt="Water Pump"
                />
                <img
                  src="images/icons/18-black.png"
                  class="icon active"
                  alt="Water Pump Active"
                />
              </button>
            </div>

            <div class="plumbing-control-item">
              <span class="plumbing-label">Water Heater</span>
              <button class="round-btn toggle-btn" data-id="51">
                <img
                  src="images/icons/17-white.png"
                  class="icon inactive"
                  alt="Water Heater"
                />
                <img
                  src="images/icons/17-black.png"
                  class="icon active"
                  alt="Water Heater Active"
                />
              </button>
            </div>
          </div>

          <!-- Right column - 4/5 width -->
          <div class="plumbing-tanks-column">
            <div class="tank-gauge-container">
              <!-- Fresh Water Tank -->
              <div class="tank-gauge-item">
                <span class="tank-label">Fresh Water</span>
                <div class="vertical-gauge-container">
                  <div class="vertical-gauge">
                    <div class="gauge-level" style="height: 75%"></div>
                  </div>
                  <div class="gauge-markers">
                    <span>100%</span>
                    <span>75%</span>
                    <span>50%</span>
                    <span>25%</span>
                    <span>0%</span>
                  </div>
                </div>
                <span class="tank-percentage">75%</span>
              </div>

              <!-- Grey Water Tank -->
              <div class="tank-gauge-item">
                <span class="tank-label">Grey Water</span>
                <div class="vertical-gauge-container">
                  <div class="vertical-gauge">
                    <div class="gauge-level" style="height: 30%"></div>
                  </div>
                  <div class="gauge-markers">
                    <span>100%</span>
                    <span>75%</span>
                    <span>50%</span>
                    <span>25%</span>
                    <span>0%</span>
                  </div>
                </div>
                <span class="tank-percentage">30%</span>
              </div>

              <!-- Black Water Tank -->
              <div class="tank-gauge-item">
                <span class="tank-label">Black Water</span>
                <div class="vertical-gauge-container">
                  <div class="vertical-gauge">
                    <div class="gauge-level" style="height: 45%"></div>
                  </div>
                  <div class="gauge-markers">
                    <span>100%</span>
                    <span>75%</span>
                    <span>50%</span>
                    <span>25%</span>
                    <span>0%</span>
                  </div>
                </div>
                <span class="tank-percentage">45%</span>
              </div>

              <!-- LPG Tank -->
              <div class="tank-gauge-item">
                <span class="tank-label">LPG</span>
                <div class="vertical-gauge-container">
                  <div class="vertical-gauge">
                    <div class="gauge-level" style="height: 60%"></div>
                  </div>
                  <div class="gauge-markers">
                    <span>100%</span>
                    <span>75%</span>
                    <span>50%</span>
                    <span>25%</span>
                    <span>0%</span>
                  </div>
                </div>
                <span class="tank-percentage">60%</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-navigation">
      <img
        class="home-logo"
        src="./images/Artek-Primary-White-w.png"
        alt="Logo"
      />
      <button class="tab-button active" data-tab="connection">
        <img
          src="images/icons/home-active.png"
          class="icon active"
          alt="Connection"
        />
        <img
          src="images/icons/home.png"
          class="icon inactive"
          alt="Connection"
        />
      </button>
      <button class="tab-button" data-tab="toggle">
        <img
          src="images/icons/power-active.png"
          class="icon active"
          alt="Toggle Buttons"
        />
        <img
          src="images/icons/power.png"
          class="icon inactive"
          alt="Toggle Buttons"
        />
      </button>
      <button class="tab-button" data-tab="momentary">
        <img
          src="images/icons/hvac-active.png"
          class="icon active"
          alt="Momentary Buttons"
        />
        <img
          src="images/icons/hvac.png"
          class="icon inactive"
          alt="Momentary Buttons"
        />
      </button>
      <button class="tab-button" data-tab="slider">
        <img
          src="images/icons/lighting-active.png"
          class="icon active"
          alt="Slider Control"
        />
        <img
          src="images/icons/lighting.png"
          class="icon inactive"
          alt="Slider Control"
        />
      </button>
      <button class="tab-button" data-tab="logs">
        <img
          src="images/icons/plumbing-active.png"
          class="icon active"
          alt="Logs"
        />
        <img src="images/icons/plumbing.png" class="icon inactive" alt="Logs" />
      </button>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
      // DOM Elements
      let socket = null;
      const connectionStatus = document.getElementById("connection-status");
      const connectBtn = document.getElementById("connect-btn");
      const disconnectBtn = document.getElementById("disconnect-btn");
      const toggleButtons = document.querySelectorAll(".toggle-btn");
      const momentaryButtons = document.querySelectorAll(".momentary-btn");
      const logElement = document.getElementById("log");

      // Constants
      const HEARTBEAT_INTERVAL = 5000; // Send heartbeat every 5 seconds
      let heartbeatInterval = null;
      let heartbeatTimer = null;

      // Initialize app on page load
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize all tab systems
        setupMainTabs();
        setupHvacTabs();
        setupLightingTabs();
        setupThermostat();
        setupSliders();
        setupVentilationButtons();

        // Connect WebSocket
        connectWebSocket();

        // Set up button event listeners
        initializeButtons();
        const multiplusBtns = document.querySelectorAll(".multiplus-btn");
        multiplusBtns.forEach((btn) => {
          btn.addEventListener("click", function () {
            // Deactivate all buttons in the group first
            multiplusBtns.forEach((b) => b.classList.remove("active"));

            // Activate only the clicked button
            this.classList.add("active");

            // Get the mode and id for sending the appropriate command
            const mode = this.getAttribute("data-mode");
            const componentId = parseInt(this.getAttribute("data-id"));

            // Send the appropriate command based on the mode
            let modeValue;
            switch (mode) {
              case "on":
                modeValue = 1;
                break;
              case "off":
                modeValue = 0;
                break;
              case "charger":
                modeValue = 2;
                break;
              default:
                modeValue = 0;
            }

            // Send command to the server
            if (socket && socket.readyState === WebSocket.OPEN) {
              const command = {
                messagetype: 17,
                messagecmd: 4,
                size: 3,
                data: [componentId, 0, modeValue],
              };
              log(`Setting MultiPlus mode to: ${mode}`);
              socket.send(JSON.stringify(command));
            }
          });
        });
      });

      // WebSocket connection management
      function connectWebSocket() {
        const host = document.getElementById("ws-host")?.value || "172.16.11.7";
        const port = document.getElementById("ws-port")?.value || "8888";

        if (socket && socket.readyState === WebSocket.OPEN) {
          socket.close();
        }

        const wsUrl = `ws://${host}:${port}/ws`;
        log(`Connecting to ${wsUrl}...`);

        try {
          socket = new WebSocket(wsUrl);

          socket.onopen = () => {
            connectionStatus.textContent = `Connected to ${wsUrl}`;
            connectionStatus.className = "connection-status connected";
            log("Connection established");
            startHeartbeat();
          };

          socket.onmessage = (event) => {
            log(`Received: ${event.data}`);

            try {
              const message = JSON.parse(event.data);

              // Handle heartbeat ping from server
              if (
                message.messagecmd === 5 &&
                message.messagetype === 48 &&
                message.size === 0
              ) {
                sendPong();
                log("Responding to server heartbeat");
              }

              // Process status updates here
              // Add more handlers for other message types
            } catch (e) {
              // Not JSON or other error
            }
          };

          socket.onclose = () => {
            connectionStatus.textContent = "Disconnected";
            connectionStatus.className = "connection-status disconnected";
            log("Connection closed");
            stopHeartbeat();
          };

          socket.onerror = (error) => {
            connectionStatus.textContent = "Connection error";
            connectionStatus.className = "connection-status disconnected";
            log("Error: " + error);
          };
        } catch (error) {
          log("Failed to connect: " + error);
        }
      }

      // Heartbeat management
      function startHeartbeat() {
        stopHeartbeat(); // Clear any existing interval

        heartbeatInterval = setInterval(() => {
          if (socket && socket.readyState === WebSocket.OPEN) {
            sendHeartbeat();
          }
        }, HEARTBEAT_INTERVAL);
      }

      function stopHeartbeat() {
        if (heartbeatInterval) {
          clearInterval(heartbeatInterval);
          heartbeatInterval = null;
        }

        if (heartbeatTimer) {
          clearTimeout(heartbeatTimer);
          heartbeatTimer = null;
        }
      }

      function sendHeartbeat() {
        const heartbeat = {
          messagetype: 48,
          messagecmd: 5,
          size: 0,
          data: [],
        };

        log("Sending heartbeat");
        socket.send(JSON.stringify(heartbeat));
      }

      function sendPong() {
        const pong = {
          messagetype: 128,
          messagecmd: 0,
          size: 1,
          data: [0],
        };

        if (socket && socket.readyState === WebSocket.OPEN) {
          socket.send(JSON.stringify(pong));
        }
      }

      // Button initialization
      function initializeButtons() {
        // Connect/disconnect buttons
        if (connectBtn) {
          connectBtn.addEventListener("click", connectWebSocket);
        }

        if (disconnectBtn) {
          disconnectBtn.addEventListener("click", () => {
            if (socket) {
              socket.close();
              stopHeartbeat();
            }
          });
        }

        // Toggle buttons (stay on or off)
        toggleButtons.forEach((btn) => {
          btn.addEventListener("click", () => {
            const componentId = parseInt(btn.dataset.id);
            const isActive = btn.classList.toggle("active");
            sendToggleButtonCommand(componentId, isActive);
          });
        });

        // Momentary buttons (brief press)
        momentaryButtons.forEach((btn) => {
          // Mouse events
          btn.addEventListener("mousedown", () => {
            const componentId = parseInt(btn.dataset.id);
            sendButtonCommand(componentId, true);
            btn.classList.add("active");
          });

          btn.addEventListener("mouseup", () => {
            const componentId = parseInt(btn.dataset.id);
            sendButtonCommand(componentId, false);
            btn.classList.remove("active");
          });

          // Touch events
          btn.addEventListener("touchstart", (e) => {
            e.preventDefault(); // Prevent scrolling
            const componentId = parseInt(btn.dataset.id);
            sendButtonCommand(componentId, true);
            btn.classList.add("active");
          });

          btn.addEventListener("touchend", (e) => {
            e.preventDefault(); // Prevent scrolling
            const componentId = parseInt(btn.dataset.id);
            sendButtonCommand(componentId, false);
            btn.classList.remove("active");
          });
        });
      }

      // Setup all sliders
      function setupSliders() {
        // Set up all sliders with value display
        const sliders = document.querySelectorAll("input[type='range']");
        sliders.forEach((slider) => {
          const valueDisplay = slider.nextElementSibling;
          if (valueDisplay && valueDisplay.classList.contains("slider-value")) {
            // Update display and send value on change
            slider.addEventListener("input", () => {
              const value = slider.value;
              valueDisplay.textContent = `${value}%`;

              // Send to server
              const sliderId = slider.id || "slider";
              sendSliderCommand(getSliderCommandId(sliderId), parseInt(value));
            });
          }
        });
      }

      // Map slider IDs to command IDs
      function getSliderCommandId(sliderId) {
        const sliderMap = {
          "fan-speed": 20,
          "interior-main": 41,
          "interior-reading": 42,
          "exterior-awning": 43,
          "rgb-brightness": 44,
        };
        return sliderMap[sliderId] || 2; // Default to 2 if unknown
      }

      // Tab navigation systems
      function setupMainTabs() {
        const tabButtons = document.querySelectorAll(".tab-button");

        tabButtons.forEach((button) => {
          button.addEventListener("click", () => {
            // Deactivate all tabs
            document.querySelectorAll(".tab-button").forEach((btn) => {
              btn.classList.remove("active");
            });
            document.querySelectorAll(".tab-content").forEach((content) => {
              content.classList.remove("active");
            });

            // Activate the selected tab
            button.classList.add("active");
            const tabId = button.getAttribute("data-tab") + "-tab";
            const tabContent = document.getElementById(tabId);

            if (tabContent) {
              tabContent.classList.add("active");
              console.log("Activated tab:", tabId);
            } else {
              console.error("Tab content not found:", tabId);
            }
          });
        });
      }

      function setupHvacTabs() {
        const hvacTabButtons = document.querySelectorAll(".hvac-tab-button");

        hvacTabButtons.forEach((button) => {
          button.addEventListener("click", () => {
            // Deactivate all buttons and tabs
            document.querySelectorAll(".hvac-tab-button").forEach((btn) => {
              btn.classList.remove("active");
            });
            document.querySelectorAll(".hvac-tab-content").forEach((tab) => {
              tab.classList.remove("active");
            });

            // Activate selected button and tab
            button.classList.add("active");
            const tabId = button.getAttribute("data-hvac-tab") + "-tab";
            document.getElementById(tabId)?.classList.add("active");
          });
        });
      }

      function setupLightingTabs() {
        const lightingTabButtons = document.querySelectorAll(
          ".lighting-tab-button"
        );
        const modeLabel = document.querySelector(".lighting-mode-label");

        lightingTabButtons.forEach((button) => {
          button.addEventListener("click", () => {
            // Deactivate all buttons and tabs
            document.querySelectorAll(".lighting-tab-button").forEach((btn) => {
              btn.classList.remove("active");
            });
            document
              .querySelectorAll(".lighting-tab-content")
              .forEach((tab) => {
                tab.classList.remove("active");
              });

            // Activate selected button and tab
            button.classList.add("active");
            const tabId = button.getAttribute("data-lighting-tab") + "-tab";
            document.getElementById(tabId)?.classList.add("active");

            // Update the visualization label
            if (modeLabel) {
              modeLabel.textContent =
                "Current Mode: " + button.textContent.trim();
            }
          });
        });

        // Setup color picker if present
        const colorPicker = document.getElementById("rgb-color");
        if (colorPicker) {
          colorPicker.addEventListener("input", () => {
            // Handle color selection
            const color = colorPicker.value;
            const r = parseInt(color.substring(1, 3), 16);
            const g = parseInt(color.substring(3, 5), 16);
            const b = parseInt(color.substring(5, 7), 16);
            sendRgbCommand(r, g, b);
          });
        }
      }

      // Add this to your setupLightingTabs function
      function setupRgbZones() {
        // Zone tab navigation
        const zoneButtons = document.querySelectorAll(".rgb-zone-button");

        zoneButtons.forEach((button) => {
          button.addEventListener("click", () => {
            // Deactivate all zone tabs
            document.querySelectorAll(".rgb-zone-button").forEach((btn) => {
              btn.classList.remove("active");
            });
            document
              .querySelectorAll(".rgb-zone-content")
              .forEach((content) => {
                content.classList.remove("active");
              });

            // Activate selected zone tab
            button.classList.add("active");
            const zoneId = button.getAttribute("data-zone-tab") + "-tab";
            document.getElementById(zoneId)?.classList.add("active");
          });
        });

        // Setup color pickers for each zone
        document.querySelectorAll(".zone-color-picker").forEach((picker) => {
          const zone = picker.getAttribute("data-zone");

          picker.addEventListener("input", () => {
            updateColorSlider(zone, picker.value);
            sendZoneRgbCommand(zone, picker.value);
          });
        });

        // Setup hue sliders for each zone
        document.querySelectorAll(".color-slider").forEach((slider) => {
          const zone = slider.getAttribute("data-zone");
          const valueDisplay = slider.nextElementSibling;

          slider.addEventListener("input", () => {
            const hue = parseInt(slider.value);
            const rgbColor = hslToHex(hue, 100, 50);

            // Update color picker to match
            document.getElementById(`rgb-color-zone${zone}`).value = rgbColor;

            // Update text display with color name
            if (valueDisplay) {
              valueDisplay.textContent = getColorName(hue);
            }

            sendZoneRgbCommand(zone, rgbColor);
          });
        });

        // Setup brightness sliders
        document
          .querySelectorAll('[id^="brightness-zone"]')
          .forEach((slider) => {
            const zone = slider.getAttribute("data-zone");
            const valueDisplay = slider.nextElementSibling;

            slider.addEventListener("input", () => {
              const brightness = slider.value;
              if (valueDisplay) {
                valueDisplay.textContent = `${brightness}%`;
              }
              sendZoneBrightnessCommand(zone, parseInt(brightness));
            });
          });

        // Setup mode toggles (RGB vs White)
        // Setup mode toggles (RGB vs White)
        // In your mode toggle event listener:
        document.querySelectorAll(".mode-btn").forEach((btn) => {
          btn.addEventListener("click", () => {
            const zone = btn.getAttribute("data-zone");
            const mode = btn.getAttribute("data-mode");

            // Update button states
            document
              .querySelectorAll(`.mode-btn[data-zone="${zone}"]`)
              .forEach((b) => {
                b.classList.remove("active");
              });
            btn.classList.add("active");

            // Show/hide color picker based on mode
            const colorPicker = document.getElementById(
              `rgb-color-zone${zone}`
            );
            if (colorPicker) {
              const colorContainer = colorPicker.closest(".color-selector");
              colorContainer.style.opacity = mode === "rgb" ? "1" : "0.3";
              colorContainer.style.pointerEvents =
                mode === "rgb" ? "auto" : "none";
            }

            // Show/hide appropriate slider groups based on mode
            const zoneContainer = document.getElementById(`zone${zone}-tab`);
            if (zoneContainer) {
              // Find slider groups within this specific zone container only
              const rgbGroup = zoneContainer.querySelector(
                `.slider-group[data-slider-type="rgb"]`
              );
              const warmthGroup = zoneContainer.querySelector(
                `.slider-group[data-slider-type="white"]`
              );

              if (rgbGroup) {
                rgbGroup.style.display = mode === "rgb" ? "block" : "none";
              }

              if (warmthGroup) {
                warmthGroup.style.display = mode === "white" ? "block" : "none";
              }
            }

            if (rgbGroup) {
              rgbGroup.style.display = mode === "rgb" ? "block" : "none";
            }

            if (warmthGroup) {
              warmthGroup.style.display = mode === "white" ? "block" : "none";
            }

            // Send appropriate command to server
            sendZoneModeCommand(zone, mode);
          });
        });
        document.querySelectorAll(".warmth-slider").forEach((slider) => {
          const zone = slider.getAttribute("data-zone");
          const valueDisplay = slider.nextElementSibling;

          slider.addEventListener("input", () => {
            const warmth = slider.value;
            if (valueDisplay) {
              valueDisplay.textContent = `${warmth}K`;
            }
            sendZoneWarmthCommand(zone, parseInt(warmth));
          });
        });

        // Add a new function to send warmth commands
        function sendZoneWarmthCommand(zone, temperature) {
          if (!socket || socket.readyState !== WebSocket.OPEN) return;

          // Calculate RGB values based on color temperature (simplified conversion)
          let r, g, b;

          // Simple temp to RGB conversion (you might want a more accurate algorithm)
          if (temperature <= 4600) {
            // Warmer colors (red-yellow range)
            const factor = (temperature - 2700) / (4600 - 2700);
            r = 255;
            g = Math.round(255 * factor);
            b = Math.round(190 * factor);
          } else {
            // Cooler colors (blue-white range)
            const factor = (temperature - 4600) / (6500 - 4600);
            r = Math.round(255 * (1 - factor * 0.3));
            g = Math.round(255 * (1 - factor * 0.1));
            b = 255;
          }

          const zoneOffset = 100 + parseInt(zone);

          const command = {
            messagetype: 17,
            messagecmd: 7, // Using a different command for white temperature
            size: 5,
            data: [zoneOffset, r, g, b, 1], // The '1' at the end indicates white mode
          };

          log(
            `Setting Zone ${zone} temperature to: ${temperature}K (R=${r}, G=${g}, B=${b})`
          );
          socket.send(JSON.stringify(command));
        }
        // Initialize color sliders
        for (let i = 1; i <= 4; i++) {
          const picker = document.getElementById(`rgb-color-zone${i}`);
          if (picker) {
            updateColorSlider(i, picker.value);
          }
        }
      }
      function setupHvacModeButtons() {
  // Define the button groups that should be mutually exclusive
  const buttonGroups = [
    // Group 1: HVAC mode buttons (Off, Cool, Heat Pump, Fan Only)
    ["24", "89", "23", "22"],
    
    // Group 2: Fan speed buttons (Low, Medium, High)
    ["25", "26", "27"]
  ];
  
  // Process each group of buttons
  buttonGroups.forEach(group => {
    const buttons = group
      .map(id => document.querySelector(`.pill-btn.toggle-btn[data-id="${id}"]`))
      .filter(btn => btn !== null);
    
    // Add click handler to each button in the group
    buttons.forEach(button => {
      // Remove default handler
      const originalOnClick = button.onclick;
      button.onclick = null;
      
      // Add custom handler for mutual exclusivity
      button.addEventListener('click', function() {
        const componentId = parseInt(this.dataset.id);
        
        // Deactivate all buttons in the group first
        buttons.forEach(btn => {
          if (btn !== this && btn.classList.contains('active')) {
            btn.classList.remove('active');
            const btnId = parseInt(btn.dataset.id);
            sendToggleButtonCommand(btnId, false); 
          }
        });
        
        // Activate this button
        this.classList.add('active');
        sendToggleButtonCommand(componentId, true);
      });
    });
  });
}

      // Call this in your initialization
      document.addEventListener("DOMContentLoaded", () => {
        // Other initialization code...
        setupHvacModeButtons();
      });
      // Helper function to update color slider visuals
      function updateColorSlider(zone, hexColor) {
        const r = parseInt(hexColor.substring(1, 3), 16);
        const g = parseInt(hexColor.substring(3, 5), 16);
        const b = parseInt(hexColor.substring(5, 7), 16);
        const [h, s, l] = rgbToHsl(r, g, b);

        const slider = document.getElementById(`hue-zone${zone}`);
        if (slider) {
          slider.value = Math.round(h * 360);

          // Update color name display
          const valueDisplay = slider.nextElementSibling;
          if (valueDisplay) {
            valueDisplay.textContent = getColorName(Math.round(h * 360));
          }
        }
      }

      // Convert RGB to HSL
      function rgbToHsl(r, g, b) {
        r /= 255;
        g /= 255;
        b /= 255;

        const max = Math.max(r, g, b);
        const min = Math.min(r, g, b);
        let h,
          s,
          l = (max + min) / 2;

        if (max === min) {
          h = s = 0;
        } else {
          const d = max - min;
          s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

          switch (max) {
            case r:
              h = (g - b) / d + (g < b ? 6 : 0);
              break;
            case g:
              h = (b - r) / d + 2;
              break;
            case b:
              h = (r - g) / d + 4;
              break;
          }

          h /= 6;
        }

        return [h, s, l];
      }

      // Convert HSL to Hex
      function hslToHex(h, s, l) {
        h /= 360;
        s /= 100;
        l /= 100;

        let r, g, b;

        if (s === 0) {
          r = g = b = l;
        } else {
          const hue2rgb = (p, q, t) => {
            if (t < 0) t += 1;
            if (t > 1) t -= 1;
            if (t < 1 / 6) return p + (q - p) * 6 * t;
            if (t < 1 / 2) return q;
            if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
            return p;
          };

          const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
          const p = 2 * l - q;

          r = hue2rgb(p, q, h + 1 / 3);
          g = hue2rgb(p, q, h);
          b = hue2rgb(p, q, h - 1 / 3);
        }

        const toHex = (x) => {
          const hex = Math.round(x * 255).toString(16);
          return hex.length === 1 ? "0" + hex : hex;
        };

        return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
      }

      // Get color name based on hue
      function getColorName(hue) {
        const colorNames = [
          { name: "Red", range: [0, 15] },
          { name: "Orange", range: [16, 45] },
          { name: "Yellow", range: [46, 75] },
          { name: "Lime", range: [76, 105] },
          { name: "Green", range: [106, 165] },
          { name: "Teal", range: [166, 195] },
          { name: "Cyan", range: [196, 225] },
          { name: "Blue", range: [226, 255] },
          { name: "Purple", range: [256, 285] },
          { name: "Magenta", range: [286, 335] },
          { name: "Pink", range: [336, 359] },
        ];

        for (const color of colorNames) {
          if (hue >= color.range[0] && hue <= color.range[1]) {
            return color.name;
          }
        }
        return "Custom";
      }

      // Send zone-specific RGB commands
      function sendZoneRgbCommand(zone, colorHex) {
        if (!socket || socket.readyState !== WebSocket.OPEN) {
          log("Not connected to WebSocket server");
          return;
        }

        const r = parseInt(colorHex.substring(1, 3), 16);
        const g = parseInt(colorHex.substring(3, 5), 16);
        const b = parseInt(colorHex.substring(5, 7), 16);

        // Zone ID offset (adjust based on your system)
        const zoneOffset = 100 + parseInt(zone);

        const command = {
          messagetype: 17,
          messagecmd: 6,
          size: 5,
          data: [zoneOffset, r, g, b, 0],
        };

        log(`Setting Zone ${zone} RGB to: R=${r}, G=${g}, B=${b}`);
        socket.send(JSON.stringify(command));
      }

      function sendZoneBrightnessCommand(zone, brightness) {
        if (!socket || socket.readyState !== WebSocket.OPEN) return;

        const zoneOffset = 200 + parseInt(zone);

        const command = {
          messagetype: 17,
          messagecmd: 3,
          size: 5,
          data: [zoneOffset, 0, 0, brightness & 0xff, (brightness >> 8) & 0xff],
        };

        log(`Setting Zone ${zone} brightness to: ${brightness}%`);
        socket.send(JSON.stringify(command));
      }

      function sendZoneModeCommand(zone, mode) {
        if (!socket || socket.readyState !== WebSocket.OPEN) return;

        const zoneOffset = 300 + parseInt(zone);
        const modeValue = mode === "rgb" ? 1 : 2;

        const command = {
          messagetype: 17,
          messagecmd: 4,
          size: 3,
          data: [zoneOffset, 0, modeValue],
        };

        log(`Setting Zone ${zone} mode to: ${mode}`);
        socket.send(JSON.stringify(command));
      }

      function setupThermostat() {
        const tempSlider = document.getElementById("temp-slider");
        const targetTemp = document.getElementById("target-temp");

        if (!tempSlider || !targetTemp) return;

        // Update display when slider changes
        tempSlider.addEventListener("input", () => {
          const temp = tempSlider.value;
          targetTemp.textContent = `${temp}°F`;
        });

        // Send command when slider is released
        tempSlider.addEventListener("change", () => {
          const temp = parseInt(tempSlider.value);
          sendThermostatCommand(temp);
        });
      }

      // WebSocket commands
      function sendToggleButtonCommand(id, state) {
        if (!socket || socket.readyState !== WebSocket.OPEN) {
          log("Not connected to WebSocket server");
          return;
        }

        const command = {
          messagetype: 17,
          messagecmd: 0,
          size: 3,
          data: [id, 0, state ? 3 : 5], // ON=3, OFF=5
        };

        log(`Sending toggle button ${id} command: ${state ? "ON" : "OFF"}`);
        socket.send(JSON.stringify(command));
      }

      function sendButtonCommand(id, state) {
        if (!socket || socket.readyState !== WebSocket.OPEN) {
          log("Not connected to WebSocket server");
          return;
        }

        const command = {
          messagetype: 17,
          messagecmd: 1,
          size: 3,
          data: [id, 0, state ? 1 : 0],
        };

        log(`Sending button ${id} command: ${state ? "ON" : "OFF"}`);
        socket.send(JSON.stringify(command));
      }

      function sendSliderCommand(id, value) {
        if (!socket || socket.readyState !== WebSocket.OPEN) {
          log("Not connected to WebSocket server");
          return;
        }

        const command = {
          messagetype: 17,
          messagecmd: 3,
          size: 5,
          data: [id, 0, 0, value & 0xff, (value >> 8) & 0xff],
        };

        log(`Setting slider ${id} to value: ${value}`);
        socket.send(JSON.stringify(command));
      }

      function sendThermostatCommand(temp) {
        if (!socket || socket.readyState !== WebSocket.OPEN) {
          log("Not connected to WebSocket server");
          return;
        }

        const command = {
          messagetype: 17,
          messagecmd: 4,
          size: 3,
          data: [30, 0, temp],
        };

        log(`Setting thermostat to ${temp}°F`);
        socket.send(JSON.stringify(command));
      }

      // Add to your setupHvacTabs function
      function setupVentControls() {
        // First Fan Control
        setupFanSpeedControl("vent-fan", 63);

        // Second Fan Control
        setupFanSpeedControl("vent-fan2", 67);

        setupFanSpeedControl("fan-speed", 45);
        // Fan Speed Control
        // Helper function to set up fan controls with 10% increments
        function setupFanSpeedControl(idPrefix, commandId) {
          const fanSpeedUp = document.getElementById(`${idPrefix}-up`);
          const fanSpeedDown = document.getElementById(`${idPrefix}-down`);
          const fanSpeedValue = document.getElementById(`${idPrefix}-value`);

          if (fanSpeedUp && fanSpeedDown && fanSpeedValue) {
            // Set initial fan speed to 30%
            let fanSpeed = 30;
            fanSpeedValue.textContent = fanSpeed + "%";

            fanSpeedUp.addEventListener("click", () => {
              if (fanSpeed < 100) {
                // Increment by 10%
                fanSpeed = Math.min(fanSpeed + 10, 100);
                fanSpeedValue.textContent = fanSpeed + "%";

                // Map percentage to appropriate server value (0-10 range)
                const serverValue = Math.round(fanSpeed / 10);
                sendFanSpeedCommand(commandId, serverValue);
              }
            });

            fanSpeedDown.addEventListener("click", () => {
              if (fanSpeed > 0) {
                // Decrement by 10%
                fanSpeed = Math.max(fanSpeed - 10, 0);
                fanSpeedValue.textContent = fanSpeed + "%";

                // Map percentage to appropriate server value
                const serverValue = Math.round(fanSpeed / 10);
                sendFanSpeedCommand(commandId, serverValue);
              }
            });
          }
        }

        // Update fan speed command to accept a specific command ID
        function sendFanSpeedCommand(commandId, speed) {
          if (!socket || socket.readyState !== WebSocket.OPEN) return;

          const command = {
            messagetype: 17,
            messagecmd: 4,
            size: 3,
            data: [commandId, 0, speed],
          };

          log(`Setting fan speed (ID: ${commandId}) to: ${speed}`);
          socket.send(JSON.stringify(command));
        }
      }

      function sendFanSpeedCommand(speed) {
        // Similar to your other commands, send to server
        if (!socket || socket.readyState !== WebSocket.OPEN) return;

        const command = {
          messagetype: 17,
          messagecmd: 4,
          size: 3,
          data: [63, 0, speed],
        };

        log(`Setting fan speed to: ${speed}`);
        socket.send(JSON.stringify(command));
      }

      function sendVentTimerCommand(time) {
        if (!socket || socket.readyState !== WebSocket.OPEN) return;

        const command = {
          messagetype: 17,
          messagecmd: 4,
          size: 3,
          data: [68, 0, time],
        };

        log(`Setting vent timer to: ${time} minutes`);
        socket.send(JSON.stringify(command));
      }

      // Add this call to your initialization
      document.addEventListener("DOMContentLoaded", () => {
        // Other initialization...
        setupVentControls();
        setupRgbZones();
      });

      function sendRgbCommand(r, g, b) {
        if (!socket || socket.readyState !== WebSocket.OPEN) {
          log("Not connected to WebSocket server");
          return;
        }

        const command = {
          messagetype: 17,
          messagecmd: 6,
          size: 5,
          data: [45, r, g, b, 0],
        };

        log(`Setting RGB to: R=${r}, G=${g}, B=${b}`);
        socket.send(JSON.stringify(command));
      }

      // Utility functions
      function log(message) {
        const entry = document.createElement("div");
        entry.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
        logElement?.appendChild(entry);
        if (logElement) logElement.scrollTop = logElement.scrollHeight;
      }

      function setupMutuallyExclusiveButtons() {
        // Define button groups that should be mutually exclusive
        const buttonGroups = [
          // First group: Cool and Fan Only buttons
          ["21", "22", "23"], // Include any other buttons that should be in this group
        ];

        // Process each group
        buttonGroups.forEach((group) => {
          const buttons = group
            .map((id) => document.querySelector(`.toggle-btn[data-id="${id}"]`))
            .filter((btn) => btn !== null);

          // Add click handler to each button in the group
          buttons.forEach((button) => {
            // Remove current onclick handler if any
            const originalOnClick = button.onclick;
            button.onclick = null;

            // Add our new click handler
            button.addEventListener("click", function () {
              // If this button is already active, do nothing special
              if (this.classList.contains("active")) {
                return;
              }

              // Deactivate all other buttons in group
              buttons.forEach((btn) => {
                if (btn !== this && btn.classList.contains("active")) {
                  btn.classList.remove("active");
                  const componentId = parseInt(btn.dataset.id);
                  sendToggleButtonCommand(componentId, false);
                }
              });

              // Activate this button
              this.classList.add("active");
              const componentId = parseInt(this.dataset.id);
              sendToggleButtonCommand(componentId, true);
            });
          });
        });
      }

      // Call this function during initialization
      document.addEventListener("DOMContentLoaded", () => {
        // Other initialization code...
        setupMutuallyExclusiveButtons();
      });

      // Add this function to your JavaScript code
      function setupVentilationButtons() {
        // Setup first vent control group (data-ids: 60, 61, 62)
        setupVentGroup("60", "61", "62");

        // Setup second vent control group (data-ids: 65, 66, 67)
        setupVentGroup("65", "66", "67");

        function setupVentGroup(onOffId, intakeId, exhaustId) {
          const onOffBtn = document.querySelector(
            `.toggle-btn[data-id="${onOffId}"]`
          );
          const intakeBtn = document.querySelector(
            `.toggle-btn[data-id="${intakeId}"]`
          );
          const exhaustBtn = document.querySelector(
            `.toggle-btn[data-id="${exhaustId}"]`
          );

          if (!onOffBtn || !intakeBtn || !exhaustBtn) return;

          // Add CSS class for styling disabled state
          intakeBtn.classList.add("vent-mode-btn");
          exhaustBtn.classList.add("vent-mode-btn");

          // Initial state - disable mode buttons if on/off is not active
          updateModeButtonsState();

          // Handle on/off button click
          onOffBtn.addEventListener("click", function () {
            // This happens after the toggle-btn class handling
            setTimeout(() => updateModeButtonsState(), 0);
          });

          // Handle intake button click
          intakeBtn.addEventListener("click", function (e) {
            if (!onOffBtn.classList.contains("active")) {
              e.preventDefault();
              e.stopPropagation();
              return false;
            }

            // Make mutually exclusive with exhaust
            if (!intakeBtn.classList.contains("active")) {
              exhaustBtn.classList.remove("active");
            }
          });

          // Handle exhaust button click
          exhaustBtn.addEventListener("click", function (e) {
            if (!onOffBtn.classList.contains("active")) {
              e.preventDefault();
              e.stopPropagation();
              return false;
            }

            // Make mutually exclusive with intake
            if (!exhaustBtn.classList.contains("active")) {
              intakeBtn.classList.remove("active");
            }
          });

          function updateModeButtonsState() {
            const isOn = onOffBtn.classList.contains("active");

            if (!isOn) {
              // Turn off and disable mode buttons when main switch is off
              intakeBtn.classList.remove("active");
              exhaustBtn.classList.remove("active");
            }

            // Visual indication of disabled state
            intakeBtn.classList.toggle("disabled", !isOn);
            exhaustBtn.classList.toggle("disabled", !isOn);
          }
        }
      }

      // AC Limit Modal functionality
      document.addEventListener("DOMContentLoaded", function () {
        const acLimitBtn = document.getElementById("ac-limit-btn");
        const acLimitModal = document.getElementById("ac-limit-modal");
        const closeModal = document.querySelector(".close-modal");
        const cancelBtn = document.getElementById("cancel-limit");
        const applyBtn = document.getElementById("apply-limit");
        const acLimitValue = document.getElementById("ac-limit-value");
        const acLimitUp = document.getElementById("ac-limit-up");
        const acLimitDown = document.getElementById("ac-limit-down");
        const presetBtns = document.querySelectorAll(".preset-btn");

        let currentAcLimit = 30;

        // Show modal when AC Limit button is clicked
        acLimitBtn.addEventListener("click", function (e) {
          e.preventDefault();
          acLimitModal.style.display = "flex";
          acLimitValue.textContent = currentAcLimit;
          updatePresetButtons(currentAcLimit);
        });

        // Up button increases the limit
        acLimitUp.addEventListener("click", function () {
          if (currentAcLimit < 50) {
            currentAcLimit++;
            acLimitValue.textContent = currentAcLimit;
            updatePresetButtons(currentAcLimit);
          }
        });

        // Down button decreases the limit
        acLimitDown.addEventListener("click", function () {
          if (currentAcLimit > 0) {
            currentAcLimit--;
            acLimitValue.textContent = currentAcLimit;
            updatePresetButtons(currentAcLimit);
          }
        });

        // Close modal with close button or cancel
        closeModal.addEventListener("click", closeAcLimitModal);
        cancelBtn.addEventListener("click", closeAcLimitModal);

        // Apply limit and close modal
        applyBtn.addEventListener("click", function () {
          // Send command to server
          if (socket && socket.readyState === WebSocket.OPEN) {
            const command = {
              messagetype: 17,
              messagecmd: 4,
              size: 3,
              data: [12, 0, currentAcLimit],
            };
            log(`Setting AC input limit to: ${currentAcLimit}A`);
            socket.send(JSON.stringify(command));
          }

          closeAcLimitModal();
        });

        // Preset buttons set value
        presetBtns.forEach((btn) => {
          btn.addEventListener("click", function () {
            const value = parseInt(btn.dataset.value);
            currentAcLimit = value;
            acLimitValue.textContent = value;

            // Highlight active preset
            updatePresetButtons(value);
          });
        });

        // Close modal if clicking outside
        window.addEventListener("click", function (event) {
          if (event.target === acLimitModal) {
            closeAcLimitModal();
          }
        });

        function closeAcLimitModal() {
          acLimitModal.style.display = "none";
        }

        function updatePresetButtons(value) {
          presetBtns.forEach((b) => {
            b.classList.toggle("active", parseInt(b.dataset.value) === value);
          });
        }
      });
    </script>
  </body>
</html>
